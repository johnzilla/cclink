---
milestone: v1.1
audited: 2026-02-22
status: gaps_found
scores:
  requirements: 7/11
  phases: 2/4
  integration: 12/12
  flows: 4/4
gaps:
  requirements:
    - id: "SEC-03"
      status: "unsatisfied"
      phase: "Phase 9"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 9 (PIN-Protected Handoffs) has not been planned or executed"
    - id: "FUNC-01"
      status: "unsatisfied"
      phase: "Phase 8"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 8 (CLI Fixes and Documentation) has not been planned or executed; --burn and --share coexist in src/cli.rs without conflicts_with"
    - id: "FUNC-02"
      status: "unsatisfied"
      phase: "Phase 8"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 8 (CLI Fixes and Documentation) has not been planned or executed"
    - id: "DOCS-01"
      status: "unsatisfied"
      phase: "Phase 8"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 8 (CLI Fixes and Documentation) has not been planned or executed"
  integration: []
  flows: []
tech_debt: []
---

# v1.1 Milestone Audit: Security Hardening & Code Review Fixes

**Audited:** 2026-02-22
**Status:** GAPS FOUND
**Milestone Goal:** Address all findings from external code review — fix security gaps, resolve functional discrepancies, and improve code quality

## Summary

7 of 11 requirements satisfied. Phases 6 and 7 are complete with all integration verified. Phases 8 and 9 have not been planned or executed — 4 requirements remain unsatisfied.

## Phase Status

| Phase | Name | Status | Plans | Verification |
|-------|------|--------|-------|--------------|
| 6 | Signed Record Format | ✓ Complete | 2/2 | Passed (7/7 truths) |
| 7 | Code Quality and Transport | ✓ Complete | 2/2 | Passed (5/5 truths) |
| 8 | CLI Fixes and Documentation | ✗ Not started | 0/? | Missing |
| 9 | PIN-Protected Handoffs | ✗ Not started | 0/? | Missing |

## Requirements Coverage (3-Source Cross-Reference)

### Satisfied (7/11)

| REQ-ID | Description | Phase | VERIFICATION | SUMMARY | REQUIREMENTS |
|--------|-------------|-------|-------------|---------|--------------|
| SEC-01 | Handoff payload signs burn and recipient fields | 6 | SATISFIED | 06-01 tagged | [x] Complete |
| SEC-02 | Key file permissions (0600) enforced explicitly | 6 | SATISFIED | 06-02 tagged | [x] Complete |
| FUNC-03 | HomeserverClient reuses session cookies | 7 | SATISFIED | 07-02 provides | [x] Complete |
| QUAL-01 | human_duration extracted to shared utility | 7 | SATISFIED | 07-01 provides | [x] Complete |
| QUAL-02 | Structured CclinkError variants instead of string matching | 7 | SATISFIED | 07-01 provides | [x] Complete |
| QUAL-03 | Dead CclinkError variants removed | 7 | SATISFIED | 07-01 provides | [x] Complete |
| QUAL-04 | List command fetches efficiently | 7 | SATISFIED | 07-02 provides | [x] Complete |

### Unsatisfied (4/11)

| REQ-ID | Description | Phase | Reason |
|--------|-------------|-------|--------|
| SEC-03 | PIN-protected handoffs (Argon2id+HKDF) | 9 | Phase not started |
| FUNC-01 | --burn/--share mutual exclusion | 8 | Phase not started |
| FUNC-02 | Correct pickup help text | 8 | Phase not started |
| DOCS-01 | PRD path cleanup (~/.pubky/ vs ~/.cclink/) | 8 | Phase not started |

## Cross-Phase Integration

**Status:** All 12 exports wired, 0 orphaned, 0 missing

| Symbol | Defined In | Consumed By | Requirement |
|--------|-----------|-------------|-------------|
| HandoffRecordSignable.burn | record/mod.rs | publish.rs, transport | SEC-01 |
| HandoffRecordSignable.recipient | record/mod.rs | publish.rs, transport | SEC-01 |
| check_key_permissions() | keys/store.rs | load_keypair(), write_keypair_atomic() | SEC-02 |
| human_duration() | util.rs | pickup.rs, list.rs | QUAL-01 |
| CclinkError::RecordNotFound | error.rs | transport (constructed), pickup.rs (detected) | QUAL-02 |
| get_all_records() | transport/mod.rs | list.rs | QUAL-04 |
| ensure_signed_in() | transport/mod.rs | publish() | FUNC-03 |

## E2E Flow Traces

| Flow | Path | Status |
|------|------|--------|
| Publish | CLI flags → HandoffRecordSignable → sign_record → publish (ensure_signed_in) | ✓ Complete |
| Pickup with tamper detection | get_record → verify_record → downcast RecordNotFound → human_duration | ✓ Complete |
| List | load_keypair (0600 check) → signin → get_all_records (one call) → human_duration | ✓ Complete |
| Key permission enforcement | load_keypair → check_key_permissions (pre-read) → write → set_permissions | ✓ Complete |

## Test Suite

| Suite | Passed | Failed | Ignored |
|-------|--------|--------|---------|
| Unit tests (lib.rs) | 34 | 0 | 1 |
| Unit tests (main.rs) | 36 | 0 | 1 |
| Integration (round_trip) | 6 | 0 | 0 |
| Integration (plaintext_leak) | 3 | 0 | 0 |
| **Total** | **79** | **0** | **2** |

Ignored tests require a live Pubky homeserver.

## Tech Debt

None accumulated in completed phases. No TODOs, stubs, or anti-patterns found.

---

*Audited: 2026-02-22*
*Auditor: Claude (gsd-audit-milestone)*
