---
phase: 13-code-quality-and-security
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/record/mod.rs
  - Cargo.toml
  - install.sh
autonomous: true
requirements:
  - DEBT-01
  - DEBT-02

must_haves:
  truths:
    - "Cargo.toml repository and homepage fields contain https://github.com/johnzilla/cclink"
    - "install.sh REPO variable is johnzilla/cclink"
    - "install.sh usage comment references johnzilla/cclink"
    - "No occurrences of user/cclink remain in Cargo.toml or install.sh"
    - "LatestPointer struct is gone from src/record/mod.rs"
    - "test_latest_pointer_serialization test is gone from src/record/mod.rs"
    - "cargo test passes with LatestPointer removed"
    - "cargo build produces no dead_code warnings for LatestPointer"
  artifacts:
    - path: "src/record/mod.rs"
      provides: "HandoffRecord, HandoffRecordSignable, Payload structs (LatestPointer removed)"
      contains: "pub struct HandoffRecord"
    - path: "Cargo.toml"
      provides: "Package metadata with correct repository URL"
      contains: "johnzilla/cclink"
    - path: "install.sh"
      provides: "Installer script with correct repo path"
      contains: "johnzilla/cclink"
  key_links:
    - from: "Cargo.toml"
      to: "GitHub repository"
      via: "repository and homepage fields"
      pattern: "repository.*johnzilla/cclink"
    - from: "install.sh"
      to: "GitHub API"
      via: "REPO variable used in curl URL"
      pattern: "REPO=\"johnzilla/cclink\""
---

<objective>
Remove dead LatestPointer code and fix placeholder repository paths.

Purpose: Eliminate dead code that carries an `#[allow(dead_code)]` suppression and replace placeholder `user/cclink` paths so the curl installer and crate metadata point to the real repository.

Output: Clean `src/record/mod.rs` without LatestPointer, correct `Cargo.toml` metadata, correct `install.sh` REPO variable.
</objective>

<execution_context>
@/home/john/.claude/get-shit-done/workflows/execute-plan.md
@/home/john/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-code-quality-and-security/13-RESEARCH.md
@src/record/mod.rs
@Cargo.toml
@install.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove LatestPointer struct and test</name>
  <files>src/record/mod.rs</files>
  <action>
    Remove the entire LatestPointer block from src/record/mod.rs. This includes:

    1. The `#[allow(dead_code)]` attribute, doc comment, derive macro, and struct definition (lines 91-106 — from `#[allow(dead_code)]` through the closing `}` of `pub struct LatestPointer`).

    2. The `test_latest_pointer_serialization` test function (lines 393-410 — from `#[test]` through the closing `}` of the function).

    After removal, verify no orphaned imports or references remain:
    - The `Serialize`, `Deserialize`, `Debug`, `Clone` imports are still used by HandoffRecord, HandoffRecordSignable, and Payload — do NOT remove them.
    - No other file references LatestPointer (confirmed by research grep).

    Ensure the closing brace of `mod tests` remains intact after removing the test function.
  </action>
  <verify>
    <automated>cd /home/john/vault/projects/github.com/cclink && cargo test --lib -- record::tests && cargo build 2>&1 | grep -v "Compiling\|Finished\|warning\[" | head -5</automated>
    <manual>Verify no LatestPointer or #[allow(dead_code)] remains in record/mod.rs</manual>
  </verify>
  <done>LatestPointer struct and test_latest_pointer_serialization are removed. cargo test passes. cargo build has no dead_code warnings for LatestPointer.</done>
</task>

<task type="auto">
  <name>Task 2: Fix placeholder repository paths</name>
  <files>Cargo.toml, install.sh</files>
  <action>
    Replace all occurrences of `user/cclink` with `johnzilla/cclink` in exactly two files:

    **Cargo.toml (lines 7-8):**
    - `repository = "https://github.com/user/cclink"` -> `repository = "https://github.com/johnzilla/cclink"`
    - `homepage = "https://github.com/user/cclink"` -> `homepage = "https://github.com/johnzilla/cclink"`

    **install.sh:**
    - Line 2 comment: `# Usage: curl -fsSL https://raw.githubusercontent.com/user/cclink/main/install.sh | sh` -> replace `user/cclink` with `johnzilla/cclink`
    - Line 6: `REPO="user/cclink"` -> `REPO="johnzilla/cclink"`

    After editing, grep both files for any remaining `user/cclink` — there must be zero occurrences.

    Do NOT search for or fix `user/cclink` in any other files. The scope is limited to Cargo.toml and install.sh per locked decision.
  </action>
  <verify>
    <automated>cd /home/john/vault/projects/github.com/cclink && grep -c "user/cclink" Cargo.toml install.sh; echo "exit: $?"</automated>
    <manual>Verify Cargo.toml repository/homepage and install.sh REPO/comment all show johnzilla/cclink</manual>
  </verify>
  <done>Cargo.toml repository and homepage fields both contain https://github.com/johnzilla/cclink. install.sh REPO variable is "johnzilla/cclink" and usage comment matches. Zero occurrences of "user/cclink" remain in either file.</done>
</task>

</tasks>

<verification>
- `cargo test` — all tests pass (LatestPointer test is gone, remaining tests unaffected)
- `cargo build` — no dead_code warnings
- `cargo clippy --all-targets -- -D warnings` — exits 0
- `grep -r "user/cclink" Cargo.toml install.sh` — returns nothing
- `grep "johnzilla/cclink" Cargo.toml install.sh` — returns 4 matches (2 in Cargo.toml, 2 in install.sh)
- `grep "LatestPointer" src/record/mod.rs` — returns nothing
</verification>

<success_criteria>
- LatestPointer struct and its test are completely removed from src/record/mod.rs
- No #[allow(dead_code)] annotation for LatestPointer remains
- Cargo.toml repository = "https://github.com/johnzilla/cclink"
- Cargo.toml homepage = "https://github.com/johnzilla/cclink"
- install.sh REPO="johnzilla/cclink"
- install.sh usage comment references johnzilla/cclink
- All cargo test, clippy, and fmt checks pass
</success_criteria>

<output>
After completion, create `.planning/phases/13-code-quality-and-security/13-02-SUMMARY.md`
</output>
